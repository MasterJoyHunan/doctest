文档地址：https://kubernetes.io/zh-cn/docs/reference/kubernetes-api/workload-resources/horizontal-pod-autoscaler-v2/

### 横向自动伸缩 HorizontalpodAutoscaler （HPA）

目前仅 deployment，replicationController，replicaSet，statefulSet 支持

cpu

```yaml
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: test-hpa
spec:
  maxReplicas: 5 # 最多不超过 5 个pod
  minReplicas: 1 # 最少不低于 1 个pod
  scaleTargetRef: # 该 Autoscaler 作用的目标资源
    apiVersion: apps/v1
    kind: Deployment
    name: shttp-dp
  metrics: 
    - type: Resource # 使用 Resource 度量
      resource:
        name: cpu
        target:
          type: Utilization
          averageUtilization: 50
```

qps

```yaml
apiVersion: autoscaling/v2beta2
kind: HorizontalPodAutoscaler
metadata:
  name: qps-hpa
spec:
  maxReplicas: 5
  minReplicas: 1
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: shttp-dp
  metrics:
    - type: Pods  # 使用 Pods 度量
      pods:
        metric:
          name: http_requests_received
        target:
          type: AverageValue
          averageValue: 10

```

### 纵向自动伸缩

官网的文档没有找到相关文档

github：https://github.com/kubernetes/autoscaler/blob/master/vertical-pod-autoscaler/README.md

```yaml
apiVersion: autoscaling.k8s.io/v1
kind: VerticalPodAutoscaler
metadata:
  name: my-app-vpa
spec:
  targetRef:
    apiVersion: "apps/v1"
    kind:       Deployment
    name:       my-app
  updatePolicy:
    updateMode: "Auto"
```

